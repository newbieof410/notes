# 分布式系统概览

## 简介
### 什么是分布式系统?
一个最简单的定义是一组计算机协同工作, 而对用户来说就像是一台设备在提供服务.

这些设备共享状态, 并行运行, 一台设备出现故障不会影响到整个系统.

以数据库系统为例. 传统的数据库将数据存储在一台设备的文件系统中, 要读写信息必须直接与这台设备通信.

<div align="center"> <img src="./img/01-1-direct.png"/> </div><br/>

拓展为分布式结构, 就是要把数据库同时部署运行在多台设备上. 但是更改对用户应该是透明的, 即使每次实际操作的数据库不同, 但在感觉上还是在使用一台设备. 比如写入数据时使用的是 1 号数据库, 再从 3 号读取也能得到这条记录.

<div align="center"> <img src="./img/01-2-distribute.png" width="500"/> </div><br>

### 为什么采用分布式结构?
分布式结构会给管理带来许多麻烦, 使系统更难调试, 部署和维护. 那为什么还要用分布式呢?

答案是使用分布式架构能使系统进行横向拓展. 还拿前面的例子来说, 如果采用的是单体结构, 那么为了处理更多的请求就只能给设备更换更好的硬件, 也就是进行纵向拓展.

更换硬件很容易, 但是硬件的性能总是有上限的, 得到的边际效用会越来越低.

<div align="center"> <img src="./img/01-3-scale.png" width="500"/> </div><br>

横向拓展则是通过增加设备来提高性能. 虽然在系统规模小的时候, 拓展成本要比纵向的方式高, 但规模达到一定程度时就能体现出它的优势:
- 成本更低;
- 拓展几乎没有上限;

除了更易于拓展, 分布式系统还具有别的优势:
- 设备集群的容错性更强;
- 信号传播的速度受限于光速, 但分布式系统使我能够把服务器部署在距客户更近的位置, 降低传播时延.

### 拓展我们的数据库
假设我们的应用有了很多用户, 同时数据库要接收两倍于它处理能力的请求, 这使得应用的性能急剧下降. 现在就来拓展数据库, 增加它的处理能力.

一般的应用通常执行读取操作多于写入和修改操作. 有一种叫做主从复制 (Master-Slave Replication) 的策略就可以提升读取的性能.

<div align="center"> <img src="./img/01-4-master-slave.png" width="500"/> </div><br>

上面新增了两台数据库从服务器, 它们的数据与主库同步. 写入操作在主库上执行, 发生更改后它异步地通知从库, 而从库只负责处理读取请求.

这样就获得了 3 倍的处理能力.

#### 带来的问题
关系数据库事物必须具备 ACID 属性, 采用分布式结构以后立马就破坏了其中的 C, 也即一致性 (Consistency) 的要求.

比如存在这样的可能性: 先写入了一条数据, 在它同步到从数据库之前就去读取, 这样得到的数据就不是最新的.

使用分布式架构不可避免地需要权衡很多这样的取舍.

## 参考资料
- [A Thorough Introduction to Distributed Systems](https://hackernoon.com/a-thorough-introduction-to-distributed-systems-3b91562c9b3c)
